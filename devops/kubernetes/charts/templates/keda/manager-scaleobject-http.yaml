{{- if .Values.keda.enabled }}
apiVersion: http.keda.sh/v1alpha1
kind: HTTPScaledObject
metadata:
  name: manager-http-scaledobject-{{ include "app.namespace" . }}
  namespace: {{ include "app.namespace" . }}
spec:
  hosts: ["teachin.westeurope.cloudapp.azure.com"]
  pathPrefixes: ["/api/{{ include "app.namespace" . }}"]

  scaleTargetRef:
    name: {{ .Values.manager.name }}-{{ .Release.Namespace }}
    service: {{ .Values.manager.name }}-{{ .Release.Namespace }}
    port: {{ .Values.manager.ports.container }}   

  replicas:
    min: 0
    max: 1

  pollingInterval: 1
  scaledownPeriod: 100             
  targetPendingRequests: 1
{{- end }}
