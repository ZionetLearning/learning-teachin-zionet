{{- if .Values.keda.enabled }}
apiVersion: http.keda.sh/v1alpha1
kind: HTTPScaledObject
metadata:
  name: manager-http-scaledobject
  namespace: {{ include "app.namespace" . }}
spec:
  hosts:
  - teachin.westeurope.cloudapp.azure.com
  scaleTargetRef:
    name: {{ .Values.manager.name }}
    port: {{ .Values.manager.ports.container }}
    service: manager
  replicas:
    min: 0               # Keep at least 1 replica to avoid cold starts
    max: 10               # Maximum replicas
  pollingInterval: 5    # Check every 5 seconds (more responsive)
  scaledownPeriod: 300    # How long to wait before scaling down (5 minutes)
  targetPendingRequests: 10
  scaleUpCooldownPeriod: 30
  scaleDownCooldownPeriod: 60
{{- end }}